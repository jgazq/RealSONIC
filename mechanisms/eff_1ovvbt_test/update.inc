PROCEDURE update() {
        A_t = Adrive * stimon  : time-dependent amplitude for lookups
        Vm = fV() : charge density dependent voltage
        y = v                  : charge density dependent rates
}